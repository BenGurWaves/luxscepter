<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Lux Scepter — Founding Bloodline</title>
<style>
/* --------- CONFIG COLORS / FONTS --------- */
:root{
  --black:#050506;           /* deep charcoal, not flat black */
  --gold:#D4AF37;            /* primary gold */
  --tan:#D2C1A3;             /* warm tan accent */
  --ivory:#F7F4EE;           /* elegant light text */
  --muted-gold: rgba(212,175,55,0.12);
  --blood:#8B0000;
  --font-word: 'Playfair Display', 'Times New Roman', serif;
  --ui-font: 'Times New Roman', serif;
  --particle-count: 6;
  --max-width: 1100px;
}

/* If you host Chomsky locally, uncomment and point to your file:
@font-face{
  font-family: 'Chomsky';
  src: url('/fonts/Chomsky.woff2') format('woff2');
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}
Then set --font-word to 'Chomsky', 'Playfair Display', serif;
*/

/* Mobile-first base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:
    radial-gradient(1200px 600px at 20% 10%, rgba(212,175,55,0.02), transparent 6%),
    radial-gradient(1000px 500px at 85% 90%, rgba(210,193,163,0.02), transparent 8%),
    var(--black);
  color:var(--ivory);
  font-family:var(--ui-font);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  overflow:hidden;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}

/* stage container */
.stage{
  width:100%;
  height:100vh;
  max-width:var(--max-width);
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-direction:column;
  text-align:center;
  pointer-events:auto;
  gap:12px;
  padding:28px;
}

/* refined vertical line */
.line-center{
  position:absolute;
  left:50%;
  top:0;
  transform:translateX(-50%) scaleY(0);
  width:1px;
  height:100%;
  background:linear-gradient(180deg, rgba(212,175,55,0.95), rgba(210,193,163,0.65));
  transform-origin:top;
  box-shadow:0 0 28px rgba(212,175,55,0.12);
  animation:drawLine 1.25s ease forwards 0.05s;
}
@keyframes drawLine{
  from{transform:translateX(-50%) scaleY(0)}
  to{transform:translateX(-50%) scaleY(1)}
}
.line-center.pulse{ opacity:0.08; animation: pulseLine 10s infinite ease-in-out; }
@keyframes pulseLine{ 0%{opacity:0.06} 50%{opacity:0.14} 100%{opacity:0.06} }

/* very gentle flash (short and warm) */
.flash{
  position:absolute;
  inset:0;
  background:rgba(212,175,55,0.14);
  opacity:0;
  pointer-events:none;
  animation: flashIn .18s linear forwards;
}
@keyframes flashIn{ 0%{opacity:1} 100%{opacity:0} }

/* central logo area - more breathing room */
.logo-wrap{
  position:relative;
  z-index:8;
  display:flex;
  align-items:center;
  flex-direction:column;
  gap:10px;
  transform:translateY(3vh);
  pointer-events:none;
}

/* crown: simpler, matte gold, tiny rotation wobble */
.crown {
  width:96px;
  height:96px;
  transform-origin:center;
  transform:scale(0.96) rotate(0deg);
  filter: drop-shadow(0 8px 22px rgba(0,0,0,0.6));
  animation: crownRise 900ms cubic-bezier(.2,.9,.28,1) .25s forwards;
}
@keyframes crownRise{ from{opacity:0; transform:translateY(8px) scale(0.92)} to{opacity:1; transform:translateY(0) scale(1)} }
/* slight breathing rotation to feel alive but dignified */
.crown.wobble{ animation: wobble 6s ease-in-out infinite; transform-origin:center; }
@keyframes wobble{
  0%{ transform:translateY(0) rotate(-2deg) }
  50%{ transform:translateY(0) rotate(2deg) }
  100%{ transform:translateY(0) rotate(-2deg) }
}

/* wordmark: elegant, slow reveal letter-by-letter */
.wordmark{
  display:inline-block;
  letter-spacing:0.06em;
  font-family:var(--font-word);
  color:var(--gold);
  font-size:1.9rem;
  font-weight:700;
  line-height:1;
  opacity:0;
  transform:translateY(6px);
  pointer-events:none;
}
.wordmark span{
  opacity:0;
  display:inline-block;
  transform:translateY(8px);
  will-change: transform, opacity;
}

/* tagline: ivory with tan accent */
.tagline{
  font-size:13px;
  margin-top:4px;
  opacity:0;
  transform:translateY(6px);
  color:var(--tan);
  letter-spacing:0.02em;
}

/* top right small UI - minimal, elegant */
.top-right{
  position:absolute;
  top:20px;
  right:20px;
  text-align:right;
  z-index:7;
  font-size:13px;
  line-height:1.05;
  color:var(--ivory);
  background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(0,0,0,0.02));
  padding:10px 12px;
  border-radius:10px;
  border:1px solid rgba(212,175,55,0.06);
  backdrop-filter: blur(3px);
}
.top-right .live-counter{ font-weight:700; color:var(--gold); font-size:15px }
.top-right .countdown{ margin-top:6px; color:var(--tan); font-weight:600 }

/* testimonial bottom-left: minimal and reserved */
.testimonial{
  position:absolute;
  left:18px;
  bottom:96px;
  z-index:6;
  max-width:60%;
  text-align:left;
  font-size:13px;
  color:var(--ivory);
  opacity:0.95;
  background:transparent;
  line-height:1.12;
}

/* CTA area: centered, generous spacing, refined buttons */
.cta-area{
  position:absolute;
  bottom:48px;
  left:50%;
  transform:translateX(-50%);
  z-index:8;
  display:flex;
  flex-direction:column;
  gap:12px;
  width:92%;
  max-width:460px;
  align-items:center;
}
.btn{
  width:100%;
  padding:14px 22px;
  border-radius:12px;
  background:transparent;
  border:2px solid rgba(212,175,55,0.95);
  color:var(--gold);
  font-weight:700;
  font-size:15px;
  letter-spacing:0.04em;
  cursor:pointer;
  transition: all .28s ease;
  backdrop-filter: blur(2px);
}
.btn.primary{
  background:transparent;
}
.btn.primary:hover,
.btn.primary:focus{
  background:linear-gradient(180deg, rgba(210,193,163,0.12), rgba(212,175,55,0.06));
  color:var(--gold);
  border-color:var(--gold);
  transform:translateY(-2px);
}
.btn.secondary{
  background:transparent;
  font-size:13px;
  padding:10px 16px;
  color:var(--ivory);
  border:1px solid rgba(255,255,255,0.04);
}

/* small note */
.small-note{ margin-top:6px; font-size:12px; color:var(--tan); opacity:0.95 }

/* particles: much fewer, softer */
.particle{
  position:absolute;
  bottom:-8%;
  width:6px;
  height:16px;
  background:linear-gradient(180deg,var(--gold), rgba(212,175,55,0.5));
  border-radius:3px;
  opacity:0.12;
  transform-origin:center;
  will-change: transform, opacity;
  z-index:2;
  filter: blur(.6px) saturate(.9);
}

/* modal (auth) - clean sheet style */
.modal-backdrop{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:40;
  padding:18px;
}
.modal{
  width:100%;
  max-width:460px;
  background:linear-gradient(180deg, #070707, #0b0b0b);
  border-radius:12px;
  border:1px solid rgba(212,175,55,0.06);
  padding:18px;
  color:var(--ivory);
  box-shadow:0 10px 50px rgba(0,0,0,0.8);
}
.modal h2{ margin:0 0 8px 0; font-size:18px; font-family:var(--font-word) }
.modal form{ display:flex; flex-direction:column; gap:10px; margin-top:8px }
.input{
  width:100%;
  padding:12px;
  border-radius:8px;
  background:#070707;
  border:1px solid rgba(255,255,255,0.04);
  color:var(--ivory);
}
.row{display:flex; gap:8px}
.toggle-auth{ font-size:13px; color:var(--tan); text-decoration:underline; cursor:pointer; background:none; border:none; padding:0}
.error{color:#ff6b6b; font-size:13px}

/* phone mock (video) - softer frame */
.phone-mock{
  width:260px;
  height:520px;
  border-radius:28px;
  overflow:hidden;
  background:#000;
  border:8px solid rgba(255,255,255,0.03);
  box-shadow: 0 12px 70px rgba(0,0,0,0.7);
}
.phone-mock video{ width:100%; height:100%; object-fit:cover }

/* larger screens */
@media(min-width:740px){
  .crown{width:128px;height:128px}
  .wordmark{font-size:2.8rem}
  .tagline{font-size:14px}
  .testimonial{left:28px; bottom:140px}
  .top-right{top:26px; right:26px}
  .cta-area{bottom:72px}
}

/* utility & gentle entrance */
.hidden{display:none}
.fadeIn{ animation:fadeUp .6s cubic-bezier(.2,.9,.28,1) forwards; }
@keyframes fadeUp{ from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:translateY(0)} }
</style>
</head>
<body>
<div class="stage" id="stage" role="main" aria-live="polite">
  <div class="line-center" id="lineCenter"></div>
  <!-- flash overlay injected dynamically -->

  <div class="logo-wrap" aria-hidden="false">
    <!-- simplified, elegant crown -->
    <svg class="crown" id="crownSvg" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <defs>
        <linearGradient id="g1" x1="0" x2="1">
          <stop offset="0" stop-color="#E6C88A"/>
          <stop offset="1" stop-color="#C99A45"/>
        </linearGradient>
      </defs>
      <g>
        <path d="M12 92 L28 46 L48 64 L64 36 L80 64 L100 46 L116 92 Z" fill="url(#g1)" stroke="rgba(0,0,0,0.14)" stroke-width="2" />
        <rect x="12" y="92" width="92" height="14" rx="6" fill="#2d241c"/>
        <circle cx="64" cy="50" r="7" fill="#c08cff" opacity="0.95" />
        <circle cx="64" cy="50" r="14" fill="rgba(192,140,255,0.06)" />
      </g>
    </svg>

    <div class="wordmark" id="wordmark" aria-label="LUX SCEPTER"></div>
    <div class="tagline" id="tagline">Rule the feed. Own the crown.</div>
  </div>

  <div class="top-right" id="topRight">
    <div class="live-counter" id="liveCounter">— people ruling right now</div>
    <div class="countdown" id="countdown">Founding Bloodline closes in —</div>
  </div>

  <div class="testimonial" id="testimonial">Founding Bloodline #127 — @kingvault</div>

  <div class="cta-area" id="ctaArea" aria-hidden="true">
    <button class="btn primary" id="claimBtn">Claim your Crown</button>
    <button class="btn secondary" id="watchBtn">Watch the Throne</button>
    <div class="small-note">Founding Bloodline exclusive access</div>
  </div>
</div>

<!-- auth modal -->
<div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true">
  <div class="modal" role="document">
    <h2 id="modalTitle">Sign Up</h2>
    <div class="error" id="modalError"></div>
    <form id="authForm" autocomplete="on">
      <input class="input" id="emailInput" type="email" placeholder="Email" required />
      <input class="input" id="passwordInput" type="password" placeholder="Password" required />
      <div class="row" style="margin-top:4px">
        <button class="btn primary" id="submitAuth" type="submit">Sign Up</button>
        <button class="btn" id="closeModal" type="button">Close</button>
      </div>
      <div style="margin-top:8px;display:flex;justify-content:space-between;align-items:center">
        <div style="font-size:13px;opacity:.9">Already have an account?</div>
        <button type="button" class="toggle-auth" id="toggleAuth">Sign In</button>
      </div>
    </form>
  </div>
</div>

<!-- video modal -->
<div class="modal-backdrop" id="videoBackdrop" style="display:none">
  <div class="phone-mock" role="dialog" aria-modal="true">
    <video id="demoVideo" playsinline muted loop controls preload="metadata">
      <source src="demo.mp4" type="video/mp4">
      Your browser does not support the video tag.
    </video>
  </div>
</div>

<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

/* ============ CONFIG ============ */
const supabaseUrl = 'https://uewvmldolwgihfkxwlsl.supabase.co'
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVld3ZtbGRvbHdnaWhma3h3bHNsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5MzQ1MjksImV4cCI6MjA3OTUxMDUyOX0.b9C00OjIkAUDPztC8RtdHcwjdgX4OrShNW_pp6r-_qI'
const supabase = createClient(supabaseUrl, supabaseKey)

/* ============ ELEMENTS ============ */
const lineCenter = document.getElementById('lineCenter')
const wordmarkEl = document.getElementById('wordmark')
const tagline = document.getElementById('tagline')
const crownSvg = document.getElementById('crownSvg')
const topRightCounter = document.getElementById('liveCounter')
const countdownEl = document.getElementById('countdown')
const testimonialEl = document.getElementById('testimonial')
const ctaArea = document.getElementById('ctaArea')
const claimBtn = document.getElementById('claimBtn')
const watchBtn = document.getElementById('watchBtn')
const modalBackdrop = document.getElementById('modalBackdrop')
const videoBackdrop = document.getElementById('videoBackdrop')
const demoVideo = document.getElementById('demoVideo')
const authForm = document.getElementById('authForm')
const modalTitle = document.getElementById('modalTitle')
const submitAuth = document.getElementById('submitAuth')
const toggleAuth = document.getElementById('toggleAuth')
const closeModal = document.getElementById('closeModal')
const modalError = document.getElementById('modalError')
const emailInput = document.getElementById('emailInput')
const passwordInput = document.getElementById('passwordInput')

let isSignUp = true

/* ============ WORDMARK BUILD ============ */
const WORD = 'LUX SCEPTER'
function buildWordmark(){
  wordmarkEl.innerHTML = ''
  for(let i=0;i<WORD.length;i++){
    const ch = WORD[i]
    const span = document.createElement('span')
    span.textContent = ch === ' ' ? '\u00A0' : ch
    span.style.transition = 'transform .34s cubic-bezier(.2,.9,.28,1), opacity .34s'
    span.style.display = 'inline-block'
    span.style.opacity = 0
    span.style.fontVariant = 'small-caps'
    wordmarkEl.appendChild(span)
  }
}
buildWordmark()

function revealWordmark(){
  const spans = wordmarkEl.querySelectorAll('span')
  wordmarkEl.style.opacity = 1
  spans.forEach((s,i)=>{
    setTimeout(()=>{
      s.style.opacity = 1
      s.style.transform = 'translateY(0)'
    }, 160 + i*90)
  })
  setTimeout(()=> {
    tagline.classList.add('fadeIn')
    tagline.style.opacity = 1
  }, 160 + spans.length*90 + 120)
  setTimeout(()=>{
    ctaArea.classList.add('fadeIn'); ctaArea.setAttribute('aria-hidden','false')
    document.getElementById('topRight').classList.add('fadeIn')
  }, 160 + spans.length*90 + 420)
}

/* line finish -> flash -> soft reveal */
lineCenter.addEventListener('animationend', ()=>{
  const flash = document.createElement('div'); flash.className='flash'; document.body.appendChild(flash)
  setTimeout(()=> flash.remove(), 220)
  revealWordmark()
  lineCenter.classList.add('pulse')
  // start crown wobble after initial reveal
  setTimeout(()=> crownSvg.classList.add('wobble'), 800)
})

/* crown gentle parallax (max 4px) */
const maxFollow = 4
document.addEventListener('pointermove', (ev)=>{
  const rect = crownSvg.getBoundingClientRect()
  const cx = rect.left + rect.width/2
  const cy = rect.top + rect.height/2
  const dx = (ev.clientX - cx)/rect.width * maxFollow
  const dy = (ev.clientY - cy)/rect.height * maxFollow
  crownSvg.style.transform = `translate(${dx}px, ${dy}px)`
})
document.addEventListener('pointerleave', ()=> crownSvg.style.transform = '')

/* ============ Particles (reduced, soft) ============ */
function spawnParticles(n = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--particle-count'))){
  const rng = (a,b)=>Math.random()*(b-a)+a
  for(let i=0;i<n;i++){
    const p = document.createElement('div'); p.className='particle'
    const left = 8 + Math.random()*84
    p.style.left = left + '%'
    p.style.bottom = (-8 - Math.random()*8) + '%'
    p.style.opacity = rng(0.06,0.14)
    p.style.width = (2 + Math.random()*6) + 'px'
    p.style.height = (8 + Math.random()*22) + 'px'
    document.body.appendChild(p)
    animateParticle(p)
  }
}
function animateParticle(el){
  const dur = 26000 + Math.random()*22000
  const leftDrift = (Math.random()*30 - 15)
  const endBottom = 110 + Math.random()*40
  const startDelay = Math.random()*9000
  el.animate([
    { transform: 'translateX(0) scale(1)', bottom: el.style.bottom, opacity: el.style.opacity },
    { transform: `translateX(${leftDrift}px) scale(${(Math.random()*0.6)+0.7})`, bottom: endBottom+'%', opacity: 0.02 }
  ], { duration: dur, easing: 'linear', delay: startDelay, iterations: Infinity })
}

/* ============ Testimonials (soft rotation) ============ */
const testimonials = [
  '“Just made $4,200 in 3 hours” — @emperorwave',
  '“They licensed my 15s Edict” — @duchessluxe',
  '“Founding Bloodline #127 — appreciation up 40x” — @kingvault'
]
let ti = 0
function rotateTestimonial(){
  testimonialEl.style.opacity = 0
  setTimeout(()=>{
    testimonialEl.textContent = testimonials[ti % testimonials.length]
    testimonialEl.style.opacity = 0.95
    ti++
  }, 520)
}
setInterval(rotateTestimonial, 4200)
rotateTestimonial()

/* ============ Live Counter (Supabase) ============ */
let displayedCount = 0
async function fetchLiveCount(){
  try{
    const res = await supabase.from('profiles').select('id', { count: 'exact', head: true })
    if(res.error && res.status !== 406) return
    const count = res.count || 0
    animateCounterTo(count)
  }catch(err){}
}
function animateCounterTo(target){
  target = Math.max(0, parseInt(target))
  const start = displayedCount
  const delta = target - start
  const steps = 28
  let i = 0
  if(delta === 0) {
    topRightCounter.textContent = `${numberWithCommas(start)} people ruling right now`
    return
  }
  const ticker = setInterval(()=>{
    i++
    const progress = i/steps
    const eased = Math.pow(progress,0.9)
    const cur = Math.round(start + delta*eased)
    displayedCount = cur
    topRightCounter.textContent = `${numberWithCommas(cur)} people ruling right now`
    if(i>=steps){ clearInterval(ticker); displayedCount = target }
  }, 70)
}
function numberWithCommas(x){ return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",") }
fetchLiveCount(); setInterval(fetchLiveCount, 10000)

/* ============ Countdown (now + 11d 4h 12m) ============ */
const now = Date.now()
const target = new Date(now + (11*24*60*60*1000) + (4*60*60*1000) + (12*60*1000))
function updateCountdown(){
  const diff = target - Date.now()
  if(diff <= 0){ countdownEl.textContent = 'Founding Bloodline closed'; return }
  const d = Math.floor(diff / (1000*60*60*24))
  const h = Math.floor((diff % (1000*60*60*24)) / (1000*60*60))
  const m = Math.floor((diff % (1000*60*60)) / (1000*60))
  countdownEl.textContent = `Founding Bloodline closes in ${d}d ${h}h ${m}m`
}
updateCountdown(); setInterval(updateCountdown, 60*1000)

/* ============ CTA / Modals ============ */
claimBtn.addEventListener('click', ()=> openAuthModal(true))
watchBtn.addEventListener('click', ()=> openVideoModal())
function openAuthModal(signUp=true){
  isSignUp = signUp
  modalTitle.textContent = isSignUp ? 'Sign Up' : 'Sign In'
  submitAuth.textContent = isSignUp ? 'Sign Up' : 'Sign In'
  modalError.textContent = ''
  emailInput.value = ''; passwordInput.value = ''
  modalBackdrop.style.display = 'flex'
  emailInput.focus()
}
function closeAuthModal(){ modalBackdrop.style.display = 'none' }
function openVideoModal(){ videoBackdrop.style.display = 'flex'; demoVideo.currentTime = 0; demoVideo.muted = true; demoVideo.play().catch(()=>{}) }
function closeVideoModal(){ videoBackdrop.style.display = 'none'; demoVideo.pause() }
toggleAuth.addEventListener('click', ()=>{
  isSignUp = !isSignUp
  modalTitle.textContent = isSignUp ? 'Sign Up' : 'Sign In'
  submitAuth.textContent = isSignUp ? 'Sign Up' : 'Sign In'
  modalError.textContent = ''
})
closeModal.addEventListener('click', closeAuthModal)
modalBackdrop.addEventListener('click', (ev)=>{ if(ev.target === modalBackdrop) closeAuthModal() })
videoBackdrop.addEventListener('click', (ev)=>{ if(ev.target === videoBackdrop) closeVideoModal() })

/* ============ Auth handling (Supabase) ============ */
authForm.addEventListener('submit', async (ev)=>{
  ev.preventDefault(); modalError.textContent = ''
  const email = emailInput.value.trim(); const password = passwordInput.value.trim()
  if(!email || !password){ modalError.textContent = 'Email and password required'; return }
  submitAuth.disabled = true
  try{
    if(isSignUp){
      const { data, error } = await supabase.auth.signUp({ email, password })
      if(error){ modalError.textContent = error.message || 'Sign up failed'; submitAuth.disabled = false; return }
      try{ await supabase.from('profiles').insert({ id: data.user.id, email, is_creator: false }) }catch(e){}
      window.location.href = 'home.html'
    } else {
      const { data, error } = await supabase.auth.signInWithPassword({ email, password })
      if(error){ modalError.textContent = error.message || 'Sign in failed'; submitAuth.disabled = false; return }
      window.location.href = 'home.html'
    }
  }catch(err){ modalError.textContent = 'Unexpected error'; console.error(err) }
  finally{ submitAuth.disabled = false }
})

/* ============ Boot sequence ============ */
document.addEventListener('DOMContentLoaded', ()=>{
  spawnParticles()
  setTimeout(()=> {
    // fallback reveal if animation not triggered
    if(!lineCenter.classList.contains('pulse')){
      const flash = document.createElement('div'); flash.className='flash'; document.body.appendChild(flash)
      setTimeout(()=> flash.remove(), 220)
      revealWordmark(); lineCenter.classList.add('pulse'); setTimeout(()=> crownSvg.classList.add('wobble'), 800)
    }
  }, 2200)
})

/* small accessibility notes */
wordmarkEl.setAttribute('aria-hidden','false'); tagline.setAttribute('aria-hidden','false')
</script>
</body>
</html>
